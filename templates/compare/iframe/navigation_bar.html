<nav
class="flex flex-row items-center px-4 py-2 bg-gray-100 border-b-2 border-gray-300"
data-iframe-id="{{ iframe_id }}"
x-data="{
  init() {
    const iframeId = this.$el.dataset.iframeId;
    const iframe = document.getElementById(iframeId);
    this.history = [];
    this.currentIndex = -1;
    this.useNav = true;
    iframe.onload = () => {
      this.iframe = iframe;
      const currentUrl = iframe.contentWindow.location.href;
      const iframeNavbar = iframe.previousElementSibling;
      this.url = iframeNavbar.querySelector('input');
      this.url.value = currentUrl;
      if (this.useNav) {
        this.history = this.history.slice(0, this.currentIndex + 1);
        this.history.push(currentUrl);
        this.currentIndex++;
      }
      this.useNav = true;
    }
  },
  previous() {
    if (this.currentIndex > 0) {
      this.currentIndex--;
      this.iframe.src = this.history[this.currentIndex];
      this.useNav = false;
    }
  },
  next() {
    if (this.currentIndex < this.history.length - 1) {
      this.currentIndex++;
      this.iframe.src = this.history[this.currentIndex];
      this.useNav = false;
    }
  },
  canGoPrevious() {
    return this.currentIndex > 0;
  },
  canGoNext() {
    return this.currentIndex < this.history.length - 1;
  },
  refresh() {
    this.iframe.contentWindow.location.reload();
    this.useNav = false;
  },
  search() {
    this.iframe.src = this.url.value;
  }
}">
    <div class="flex gap-2">
        <button
        class="group w-8 h-8 flex items-center justify-center transition-color duration-200 bg-gray-50 rounded-md"
        :class="!canGoPrevious() ? 'bg-gray-50/70' : 'hover:bg-blue-100 cursor-pointer'"
        :disabled="!canGoPrevious()"
        @click="previous()"
        >
            <svg
            :class="canGoPrevious() ? 'fill-[#5f6368] group-hover:fill-blue-700' : 'fill-[#5f6368]/60'"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="currentColor"
            >
                <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
            </svg>
        </button>
        <button
        class="group w-8 h-8 flex items-center justify-center transition-color duration-200 bg-gray-50 rounded-md"
        :class="!canGoNext() ? 'bg-gray-50/70' : 'hover:bg-blue-100 cursor-pointer'"
        :disabled="!canGoNext()"
        @click="next()"
        >
            <svg
            :class="canGoNext() ? 'fill-[#5f6368] group-hover:fill-blue-700' : 'fill-[#5f6368]/60'"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="currentColor"
            >
                <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/>
            </svg>
        </button>
        <button
        class="group w-8 h-8 flex items-center justify-center transition-color duration-200 cursor-pointer bg-gray-50 rounded-md hover:bg-blue-100"
        @click="refresh()"
        >
            <svg class="fill-[#5f6368] group-hover:fill-blue-700" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
            </svg>
        </button>
    </div>
    <div class="w-full px-4">
        <input
        class="rounded-2xl w-full h-8 px-4 py-2 bg-gray-50 border-1 border-gray-400"
        type="text"
        placeholder="Enter URL..."
        @keydown.enter="search()"
        >
    </div>
    <div class="px-4 py-2 text-xs text-center tracking-widest rounded-sm text-white border-2 border-green-100 bg-green-900 font-base">{% if iframe_id == 'before' %}BEFORE{% else %}AFTER{% endif %}</div>
</nav>
